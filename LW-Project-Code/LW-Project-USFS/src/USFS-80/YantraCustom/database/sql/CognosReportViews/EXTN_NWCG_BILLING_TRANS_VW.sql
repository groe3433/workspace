CREATE OR REPLACE FORCE VIEW EXTN_NWCG_BILLING_TRANS_VW ("SEQUENCE_KEY", "TRANS TYPE", "TRANS_DATE", "TRANS_QTY", "TRANS_AMOUNT", "TRANSACTION_NO", "TRANSACTION_HEADER_KEY", "TRANSACTION_LINE_KEY", "ENTERPRISE_CODE", "DOCUMENT_TYPE", "CACHE ID", "INCIDENT_NO", "INCIDENT_YEAR", "INCIDENT_NAME", "ITEM ID", "ITEM_CLASSIFICATION", "ITEM_DESCRIPTION", "UOM", "UNIT_COST", "INCIDENT_FS_ACCT_CODE", "INCIDENT_FS_OVERRIDE_CODE", "INCIDENT_BLM_ACCT_CODE", "INCIDENT_OTHER_ACCT_CODE", "IS_ACCOUNT_SPLIT", "SPLIT_AMT_NUMBER", "LAST_FS_ACCT_CODE", "LAST_FS_OVERRIDE_CODE", "LAST_BLM_ACCT_CODE", "LAST_OTHER_ACCT_CODE", "DISPOSITION_CODE", "LOCATION_ID", "EXTRACT_TRANS_NO", "LAST_EXTRACT_DATE", "IS_EXTRACTED", "IS_REVIEWED", "CREATETS", "MODIFYTS", "CREATEUSERID", "MODIFYUSERID", "CREATEPROGID", "MODIFYPROGID", "LOCKID", "ITEM_PRODUCT_LINE", "TRANSACTION_FISCAL_YEAR", "DOCUMENT_NO", "INV_COMMENTS")
AS
  SELECT SEQUENCE_KEY,
    TRANS_TYPE "TRANS TYPE",
    to_date(TO_CHAR(TRANS_DATE,'Mon DD YYYY'),'Mon DD YYYY') "TRANS_DATE",
    TRANS_QTY,
    TRANS_AMOUNT,
    TRANSACTION_NO,
    TRANSACTION_HEADER_KEY,
    TRANSACTION_LINE_KEY,
    ENTERPRISE_CODE,
    DOCUMENT_TYPE,
    CACHE_ID "CACHE ID",
    INCIDENT_NO,
    INCIDENT_YEAR,
    INCIDENT_NAME,
    ITEM_ID "ITEM ID",
    ITEM_CLASSIFICATION,
    ITEM_DESCRIPTION,
    UOM,
    UNIT_COST,
    INCIDENT_FS_ACCT_CODE,
    INCIDENT_FS_OVERRIDE_CODE,
    INCIDENT_BLM_ACCT_CODE,
    INCIDENT_OTHER_ACCT_CODE,
    IS_ACCOUNT_SPLIT,
    SPLIT_AMT_NUMBER,
    LAST_FS_ACCT_CODE,
    LAST_FS_OVERRIDE_CODE,
    LAST_BLM_ACCT_CODE,
    LAST_OTHER_ACCT_CODE,
    DISPOSITION_CODE,
    LOCATION_ID,
    EXTRACT_TRANS_NO,
    LAST_EXTRACT_DATE,
    IS_EXTRACTED,
    IS_REVIEWED,
    CREATETS,
    MODIFYTS,
    CREATEUSERID,
    MODIFYUSERID,
    CREATEPROGID,
    MODIFYPROGID,
    LOCKID,
    ITEM_PRODUCT_LINE,
    TRANSACTION_FISCAL_YEAR,
    DOCUMENT_NO,
    (SELECT DISTINCT reason_text
    FROM yfs_locn_inventory_audit
    WHERE reference_1            = a.transaction_no
    AND LENGTH(a.transaction_no) > 1
    ) "INV_COMMENTS"
  FROM nwcg_billing_transaction a;