CREATE OR REPLACE FORCE VIEW EXTN_NWCG_TRACKABLE_ITEM_VW ("TRACKABLE_ITEM_KEY", "TRACKABLE ID", "SYSTEM_NO", "ITEM ID", "DESCRIPTION", "UNIT_COST", "UNIT_OF_MEASURE", "LOT_ATTRIBUTE_1", "LOT_ATTRIBUTE_3", "ACQUISITION_COST", "ACQUISITION_DATE", "WO_SERVICE_COST", "CUSTOMER ID", "OWNER_UNIT_NAME", "SERIAL_STATUS", "STATUS", "CACHE ID", "STATUS_INCIDENT_NO", "STATUS_INCIDENT_YEAR", "STATUS_BUYER_ORGANIZATION_CODE", "LAST_INCIDENT_NO", "LAST_INCIDENT_YEAR", "LAST_BUYER_ORGANIZATION_CODE", "TYPE", "LAST_DOCUMENT_NUMBER", "LAST_TRANSACTION_DATE", "KIT_ITEM_ID", "KIT_SERIAL_NO", "KIT_PRIMARY_ITEM_ID", "KIT_PRIMARY_SERIAL_NO", "BATCH_NO", "REVISION_NO", "FS_ACCOUNT_CODE", "BLM_ACCOUNT_CODE", "OTHER_ACCOUNT_CODE", "SECONDARY_SERIAL", "CREATETS", "MODIFYTS", "CREATEUSERID", "MODIFYUSERID", "CREATEPROGID", "MODIFYPROGID", "LOCKID", "CURRENT_LOCATION")
AS
  SELECT a.TRACKABLE_ITEM_KEY,
    a.SERIAL_NO "TRACKABLE ID",
    a.system_no,
    a.ITEM_ID "ITEM ID",
    b.DESCRIPTION,
    b.unit_cost,
    a.UNIT_OF_MEASURE,
    a.LOT_ATTRIBUTE_1,
    a.LOT_ATTRIBUTE_3,
    a.ACQUISITION_COST,
    a.ACQUISITION_DATE,
    a.WO_SERVICE_COST,
    a.OWNER_UNIT_ID "CUSTOMER ID",
    a.OWNER_UNIT_NAME,
    a.SERIAL_STATUS,
    a.SERIAL_STATUS_DESC "STATUS",
    a.STATUS_CACHE_ID "CACHE ID",
    a.STATUS_INCIDENT_NO,
    a.STATUS_INCIDENT_YEAR,
    a.STATUS_BUYER_ORGANIZATION_CODE,
    a.LAST_INCIDENT_NO,
    a.LAST_INCIDENT_YEAR,
    a.LAST_BUYER_ORGANIZATION_CODE,
    a.TYPE,
    a.LAST_DOCUMENT_NUMBER,
    a.LAST_TRANSACTION_DATE,
    a.KIT_ITEM_ID,
    a.KIT_SERIAL_NO,
    a.KIT_PRIMARY_ITEM_ID,
    a.KIT_PRIMARY_SERIAL_NO,
    a.BATCH_NO,
    a.REVISION_NO,
    a.FS_ACCOUNT_CODE,
    a.BLM_ACCOUNT_CODE,
    a.OTHER_ACCOUNT_CODE,
    a.SECONDARY_SERIAL,
    a.CREATETS,
    a.MODIFYTS,
    a.CREATEUSERID,
    a.MODIFYUSERID,
    a.CREATEPROGID,
    a.MODIFYPROGID,
    a.LOCKID,
    (SELECT DISTINCT b1.node_key
    FROM yfs_item a1,
      yfs_location_inventory b1,
      yfs_inventory_item c1
    WHERE a1.item_id          = c1.item_id
    AND b1.inventory_item_key = c1.inventory_item_key
    AND a1.item_id            = a.item_id
    ) "CURRENT_LOCATION"
  FROM nwcg_trackable_item a ,
    yfs_item b
  WHERE rtrim(a.item_id) = rtrim(b.item_id)
  AND b.status           = '3000';